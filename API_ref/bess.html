<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BESS modules &mdash; BESS-KGE  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Scoring functions" href="scoring.html" />
    <link rel="prev" title="Negative samplers" href="negative_sampler.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            BESS-KGE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dataset.html">KG Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="sharding.html">Sharding utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_sampler.html">Batch samplers</a></li>
<li class="toctree-l1"><a class="reference internal" href="negative_sampler.html">Negative samplers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">BESS modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#besskge.bess.BessKGE"><code class="docutils literal notranslate"><span class="pre">BessKGE</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#besskge.bess.BessKGE.forward"><code class="docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#besskge.bess.BessKGE.n_embedding_parameters"><code class="docutils literal notranslate"><span class="pre">BessKGE.n_embedding_parameters</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#besskge.bess.BessKGE.score_batch"><code class="docutils literal notranslate"><span class="pre">BessKGE.score_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#besskge.bess.BessKGE.training"><code class="docutils literal notranslate"><span class="pre">BessKGE.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#besskge.bess.EmbeddingMovingBessKGE"><code class="docutils literal notranslate"><span class="pre">EmbeddingMovingBessKGE</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#besskge.bess.EmbeddingMovingBessKGE.entity_embedding_size"><code class="docutils literal notranslate"><span class="pre">EmbeddingMovingBessKGE.entity_embedding_size</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#besskge.bess.EmbeddingMovingBessKGE.score_batch"><code class="docutils literal notranslate"><span class="pre">EmbeddingMovingBessKGE.score_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#besskge.bess.EmbeddingMovingBessKGE.training"><code class="docutils literal notranslate"><span class="pre">EmbeddingMovingBessKGE.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#besskge.bess.ScoreMovingBessKGE"><code class="docutils literal notranslate"><span class="pre">ScoreMovingBessKGE</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#besskge.bess.ScoreMovingBessKGE.entity_embedding_size"><code class="docutils literal notranslate"><span class="pre">ScoreMovingBessKGE.entity_embedding_size</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#besskge.bess.ScoreMovingBessKGE.score_batch"><code class="docutils literal notranslate"><span class="pre">ScoreMovingBessKGE.score_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#besskge.bess.ScoreMovingBessKGE.training"><code class="docutils literal notranslate"><span class="pre">ScoreMovingBessKGE.training</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#besskge.bess.TopKQueryBessKGE"><code class="docutils literal notranslate"><span class="pre">TopKQueryBessKGE</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#besskge.bess.TopKQueryBessKGE.forward"><code class="docutils literal notranslate"><span class="pre">TopKQueryBessKGE.forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#besskge.bess.TopKQueryBessKGE.training"><code class="docutils literal notranslate"><span class="pre">TopKQueryBessKGE.training</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scoring.html">Scoring functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="loss.html">Loss functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="metric.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="embedding.html">Embedding utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">General-purpose utility functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BESS-KGE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">BESS modules</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/API_ref/bess.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bess-modules">
<h1>BESS modules<a class="headerlink" href="#bess-modules" title="Permalink to this heading"></a></h1>
<p>When distributing the workload over <span class="math notranslate nohighlight">\(n\)</span> workers (=IPUs), BESS
randomly splits the entity embedding table in <span class="math notranslate nohighlight">\(n\)</span> shards of equal
size, each of which is stored in one of the workers’ memory. The
embedding table for relation types, on the other hand, is replicated
across workers, as it is usually much smaller.</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../_images/embedding_sharding.jpg"><img alt="../_images/embedding_sharding.jpg" src="../_images/embedding_sharding.jpg" style="height: 250px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>Figure 1</strong>. Entity table sharding across <span class="math notranslate nohighlight">\(n=3\)</span> workers.</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The entity sharding induces a partitioning of the triples in the
dataset, according to the shardpair of head entity and tail entity. At
execution time (for both training and inference) batches are constructed
by sampling triples uniformly from each of the <span class="math notranslate nohighlight">\(n^2\)</span> shardpairs.
Negative entities, used to corrupt the head or tail of a triple in order
to construct negative samples, are also sampled in a balanced way to ensure
a variety that is beneficial to the final embedding quality.</p>
<figure class="align-center" id="id4">
<span id="figure2"></span><a class="reference internal image-reference" href="../_images/batch_together.jpg"><img alt="../_images/batch_together.jpg" src="../_images/batch_together.jpg" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>Figure 2</strong>. <em>Left</em>: a batch is made of <span class="math notranslate nohighlight">\(n^2=9\)</span> blocks, each
containing the same number of triples. The head embeddings of triples
in block <span class="math notranslate nohighlight">\((i,j)\)</span> are stored on worker <span class="math notranslate nohighlight">\(i\)</span>, the tail
embeddings on worker <span class="math notranslate nohighlight">\(j\)</span>, for <span class="math notranslate nohighlight">\(i,j = 0,1,2\)</span>. <em>Right</em>: the
negative entities used to corrupt triples in block <span class="math notranslate nohighlight">\((i,j)\)</span> are
sampled in equal number from all of the <span class="math notranslate nohighlight">\(n\)</span> shards (possibly with
padding at inference time). In this example, negative samples are constructed
by corrupting tails.</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>This batch cook-up scheme allows us to balance workload and
communication across workers. First, each worker needs to gather the
same number of embeddings from its on-chip memory, both for positive and
negative samples. These include the embeddings neeeded by the worker
itself, and the embeddings needed by its peers.</p>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../_images/gather.jpg"><img alt="../_images/gather.jpg" src="../_images/gather.jpg" style="width: 650px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>Figure 3</strong>. The required embeddings are gathered from the IPUs’
SRAM. Each worker needs to retrieve the head embeddings for <span class="math notranslate nohighlight">\(n\)</span>
positive triple blocks, and the same for tail embeddings (the
<span class="math notranslate nohighlight">\(3 + 3\)</span> triangles of same colour in <a class="reference internal" href="#figure2"><span class="std std-ref">Figure 2 (left)</span></a>).
In addition to that, the worker gathers the
portion (=<span class="math notranslate nohighlight">\(1/3\)</span>) stored in its memory of the negative tails
needed by all of the <span class="math notranslate nohighlight">\(n^2\)</span> blocks.</span><a class="headerlink" href="#id5" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The batch in <a class="reference internal" href="#figure2"><span class="std std-ref">Figure 2</span></a> can then be reconstrcuted by
sharing the embeddings of positive <strong>tails</strong> and negative entities
between workers through a balanced AllToAll collective operator. Head
embeddings remain inplace, as each triple block is then scored on the
worker where the head embedding is stored.</p>
<figure class="align-center" id="id6">
<a class="reference internal image-reference" href="../_images/alltoall.jpg"><img alt="../_images/alltoall.jpg" src="../_images/alltoall.jpg" style="width: 650px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>Figure 4</strong>. Embeddings of positive and negative tails are exchanged
between workers with an AllToAll collective (red arrows), which
effectively transposes rows and columns of the <span class="math notranslate nohighlight">\(n^2\)</span> blocks in
the picture. After this exchange, each worker has the correct
<span class="math notranslate nohighlight">\(n\)</span> blocks of positive triples and <span class="math notranslate nohighlight">\(n\)</span> blocks of negative
tails to compute positive and negative scores.</span><a class="headerlink" href="#id6" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The distribution scheme presented above is implemented in <a class="reference internal" href="#besskge.bess.EmbeddingMovingBessKGE" title="besskge.bess.EmbeddingMovingBessKGE"><code class="xref py py-class docutils literal notranslate"><span class="pre">besskge.bess.EmbeddingMovingBessKGE</span></code></a>.
While communication is always balanced, exchanging negative embeddings between workers can turn out to be expensive
when using many negative samples per triple, or when the embedding dimension is large.
In these cases, using <a class="reference internal" href="#besskge.bess.ScoreMovingBessKGE" title="besskge.bess.ScoreMovingBessKGE"><code class="xref py py-class docutils literal notranslate"><span class="pre">besskge.bess.ScoreMovingBessKGE</span></code></a> can increase overall throughput.
This alternative distribution scheme works in the same way as <a class="reference internal" href="#besskge.bess.EmbeddingMovingBessKGE" title="besskge.bess.EmbeddingMovingBessKGE"><code class="xref py py-class docutils literal notranslate"><span class="pre">besskge.bess.EmbeddingMovingBessKGE</span></code></a> for
the sharding of entities and partitioning of triples, as well as for the way embeddings for positive triples are
shared through AllToAll collectives and scored. The difference lies in how negative scores are computed: instead of
sending negative embeddings to the query’s worker, all queries are replicated on each device through an AllGather
collective, scored against the (partial) set of negatives stored on the device and then the scores are
sent to the correct worker via a new, balanced AllToAll.
This allows us to communicate negative <strong>scores</strong> instead of negative embeddings, which is cheaper, although it
requires additional collective communications between devices.</p>
<figure class="align-center" id="id7">
<a class="reference internal image-reference" href="../_images/allgather.jpg"><img alt="../_images/allgather.jpg" src="../_images/allgather.jpg" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>Figure 5</strong>. Through an AllGather collective, the head embeddings of the <span class="math notranslate nohighlight">\(n^2\)</span> blocks are
replicated on all workers. These are then scored against the corresponding negative tails stored on the worker.</span><a class="headerlink" href="#id7" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id8">
<a class="reference internal image-reference" href="../_images/score_moving_alltoall.jpg"><img alt="../_images/score_moving_alltoall.jpg" src="../_images/score_moving_alltoall.jpg" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-text"><strong>Figure 6</strong>. Using a final AllToAll (red arrows) the partial negative <strong>scores</strong> are put back on the worker
where the head embeddings came from. After this, each worker has the complete set of negative scores for each
of the <span class="math notranslate nohighlight">\(n\)</span> triple blocks it is responsible for.</span><a class="headerlink" href="#id8" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<span class="target" id="module-besskge.bess"></span><dl class="py class">
<dt class="sig sig-object py" id="besskge.bess.BessKGE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.bess.</span></span><span class="sig-name descname"><span class="pre">BessKGE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">negative_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augment_negative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/besskge/bess.html#BessKGE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.BessKGE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for distributed training and inference of KGE models, using
the distribution framework BESS <span id="id1">[<a class="reference internal" href="../bibliography.html#id27" title="Alberto Cattaneo, Daniel Justus, Harry Mellor, Douglas Orr, Jerome Maloberti, Zhenying Liu, Thorin Farnsworth, Andrew Fitzgibbon, Blazej Banaszewski, and Carlo Luschi. BESS: balanced entity sampling and sharing for large-scale knowledge graph completion. arXiv preprint arXiv:2211.12281, 2021.">CJM+21</a>]</span>.
To be used in combination with a batch sampler based on a
“ht_shardpair”-partitioned triple set.</p>
<dl class="py method">
<dt class="sig sig-object py" id="besskge.bess.BessKGE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triple_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triple_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/besskge/bess.html#BessKGE.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.BessKGE.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward step, comprising of four phases:</p>
<ol class="arabic simple">
<li><p>Gather relevant embeddings from local memory;</p></li>
<li><p>Share embeddings with other devices through collective operators;</p></li>
<li><p>Score positive and negative triples;</p></li>
<li><p>Compute loss/metrics.</p></li>
</ol>
<p>Each device scores <cite>n_shard * positive_per_partition</cite> positive triples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (1, n_shard, positive_per_partition)
Head indices.</p></li>
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (1, n_shard, positive_per_partition)
Relation indices.</p></li>
<li><p><strong>tail</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (1, n_shard, positive_per_partition)
Tail indices.</p></li>
<li><p><strong>triple_mask</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – shape: (1, n_shard, positive_per_partition)
Mask to filter the triples in the microbatch
before computing metrics.</p></li>
<li><p><strong>negative</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (1, n_shard, B, padded_negative)
Indices of negative entities,
with <cite>B = 1, 2 or n_shard * positive_per_partition</cite>.</p></li>
<li><p><strong>triple_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – shape: (1, n_shard * positive_per_partition,) or (1,)
Weights of positive triples.</p></li>
<li><p><strong>negative_mask</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – shape: (1, B, n_shard, padded_negative)
Mask to identify padding negatives, to discard when computing metrics.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Microbatch loss, scores, metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="besskge.bess.BessKGE.n_embedding_parameters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_embedding_parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#besskge.bess.BessKGE.n_embedding_parameters" title="Permalink to this definition"></a></dt>
<dd><p>number of trainable parameters in the embedding tables</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>return</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.bess.BessKGE.score_batch">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">score_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/besskge/bess.html#BessKGE.score_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.BessKGE.score_batch" title="Permalink to this definition"></a></dt>
<dd><p>Compute positive and negative scores for the microbatch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>tail</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>negative</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>positive (shape: (n_shard * positive_per_partition,))
and negative (shape: (n_shard * positive_per_partition, n_negative))
scores of the microbatch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.bess.BessKGE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.bess.BessKGE.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.bess.EmbeddingMovingBessKGE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.bess.</span></span><span class="sig-name descname"><span class="pre">EmbeddingMovingBessKGE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">negative_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augment_negative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/besskge/bess.html#EmbeddingMovingBessKGE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.EmbeddingMovingBessKGE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.bess.BessKGE" title="besskge.bess.BessKGE"><code class="xref py py-class docutils literal notranslate"><span class="pre">BessKGE</span></code></a></p>
<p>Compute negative scores on the shard where the positive triples
are scored (i.e. head shard).
This requires moving embedding of negative entities between shards,
which can be done with a single AllToAll collective.</p>
<p>Each triple is scored against a total number of entities equal to
<cite>n_negative * n_shard</cite> if negative sample sharing is disabled, otherwise
<cite>n_negative * n_shard * B</cite> (see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a>) for “h”, “t”
corruption scheme, <cite>n_negative * n_shard * (B &gt; 2 ? B // 2 : 1)</cite> for “ht”.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.bess.EmbeddingMovingBessKGE.entity_embedding_size">
<span class="sig-name descname"><span class="pre">entity_embedding_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#besskge.bess.EmbeddingMovingBessKGE.entity_embedding_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.bess.EmbeddingMovingBessKGE.score_batch">
<span class="sig-name descname"><span class="pre">score_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/besskge/bess.html#EmbeddingMovingBessKGE.score_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.EmbeddingMovingBessKGE.score_batch" title="Permalink to this definition"></a></dt>
<dd><p>Compute positive and negative scores for the microbatch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>tail</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>negative</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>positive (shape: (n_shard * positive_per_partition,))
and negative (shape: (n_shard * positive_per_partition, n_negative))
scores of the microbatch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.bess.EmbeddingMovingBessKGE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.bess.EmbeddingMovingBessKGE.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.bess.ScoreMovingBessKGE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.bess.</span></span><span class="sig-name descname"><span class="pre">ScoreMovingBessKGE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">negative_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augment_negative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/besskge/bess.html#ScoreMovingBessKGE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.ScoreMovingBessKGE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.bess.BessKGE" title="besskge.bess.BessKGE"><code class="xref py py-class docutils literal notranslate"><span class="pre">BessKGE</span></code></a></p>
<p>Compute negative scores on the shard where the negative entities are stored.
This avoids moving embeddings between shards (convenient when the number of
negative entities is very large, e.g. when scoring queries against all entities
in the KG, or when using large embedding size).</p>
<p>AllGather collectives are required to replicate queries on all devices, so that
they can be scored against the local negative entities. An AllToAll collective
is then used to send the scores back to the correct device.</p>
<p>For the number of negative samples scored for each triple, see the corresponding
value documented in <a class="reference internal" href="#besskge.bess.EmbeddingMovingBessKGE" title="besskge.bess.EmbeddingMovingBessKGE"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmbeddingMovingBessKGE</span></code></a> and, if using negative
sample sharing, multiply that by n_shard.</p>
<p>Does not support local sampling or negative augmentation.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.bess.ScoreMovingBessKGE.entity_embedding_size">
<span class="sig-name descname"><span class="pre">entity_embedding_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#besskge.bess.ScoreMovingBessKGE.entity_embedding_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.bess.ScoreMovingBessKGE.score_batch">
<span class="sig-name descname"><span class="pre">score_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/besskge/bess.html#ScoreMovingBessKGE.score_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.ScoreMovingBessKGE.score_batch" title="Permalink to this definition"></a></dt>
<dd><p>Compute positive and negative scores for the microbatch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>tail</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>negative</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>positive (shape: (n_shard * positive_per_partition,))
and negative (shape: (n_shard * positive_per_partition, n_negative))
scores of the microbatch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.bess.ScoreMovingBessKGE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.bess.ScoreMovingBessKGE.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.bess.TopKQueryBessKGE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.bess.</span></span><span class="sig-name descname"><span class="pre">TopKQueryBessKGE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidate_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/besskge/bess.html#TopKQueryBessKGE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.TopKQueryBessKGE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Distributed scoring of (h, r, ?) or (?, r, t) queries (against
all entities in the KG, or a query-specific set)
returning top-k most likely completions, based on BESS <span id="id2">[<a class="reference internal" href="../bibliography.html#id27" title="Alberto Cattaneo, Daniel Justus, Harry Mellor, Douglas Orr, Jerome Maloberti, Zhenying Liu, Thorin Farnsworth, Andrew Fitzgibbon, Blazej Banaszewski, and Carlo Luschi. BESS: balanced entity sampling and sharing for large-scale knowledge graph completion. arXiv preprint arXiv:2211.12281, 2021.">CJM+21</a>]</span>
inference scheme.
To be used in combination with a batch sampler based on a
“h_shard”/”t_shard”-partitioned triple set.
If the correct tail/head is known, can be passed as an input
in order to compute metrics on the final predictions.</p>
<p>This class is recommended over <a class="reference internal" href="#besskge.bess.BessKGE" title="besskge.bess.BessKGE"><code class="xref py py-class docutils literal notranslate"><span class="pre">BessKGE</span></code></a> when the number of
negatives is large, e.g. when one wants to score queries against
all entities in the KG, as it uses a sliding window over the
negative sample size via an on-device for-loop.</p>
<p>Only to be used for inference.</p>
<dl class="py method">
<dt class="sig sig-object py" id="besskge.bess.TopKQueryBessKGE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triple_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/besskge/bess.html#TopKQueryBessKGE.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.TopKQueryBessKGE.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward step.</p>
<p>Similarly to <a class="reference internal" href="#besskge.bess.ScoreMovingBessKGE" title="besskge.bess.ScoreMovingBessKGE"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScoreMovingBessKGE</span></code></a>, candidates are scored
on the device where they are gathered, then scores for the same
query against candidates in different shards are collected together
via an AllToAll.
At each iteration of the for loop, only the top-k best query responses and
respective scores are kept to be used in the next iteration, while the
rest is discarded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (shard_bs,)
Relation indices.</p></li>
<li><p><strong>head</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – shape: (shard_bs,)
Head indices, if known. Defaults to False.</p></li>
<li><p><strong>tail</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – shape: (shard_bs,)
Tail indices, if known. Defaults to False.</p></li>
<li><p><strong>negative</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – shape: (n_shard, B, padded_negative)
Candidates to score against the queries.
It can be the same set for all queries (B=1),
or specific for each query in the batch (B=shard_bs).
If None, score each query against all entities in the KG.
Defaults to None.</p></li>
<li><p><strong>triple_mask</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – shape: (shard_bs,)
Mask to filter the triples in the microbatch
before computing metrics. Defaults to None.</p></li>
<li><p><strong>negative_mask</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – shape: (n_shard, B, padded_negative)
If candidates are provided, mask to discard padding
negatives when computing best completions.
Requires the use of <code class="code docutils literal notranslate"><span class="pre">mask_on_gather=True</span></code> in the candidate sampler
(see <a class="reference internal" href="negative_sampler.html#besskge.negative_sampler.TripleBasedShardedNegativeSampler" title="besskge.negative_sampler.TripleBasedShardedNegativeSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">besskge.negative_sampler.TripleBasedShardedNegativeSampler</span></code></a>).
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.bess.TopKQueryBessKGE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.bess.TopKQueryBessKGE.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="negative_sampler.html" class="btn btn-neutral float-left" title="Negative samplers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="scoring.html" class="btn btn-neutral float-right" title="Scoring functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright (c) 2023 Graphcore Ltd. All rights reserved.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>