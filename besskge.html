<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>besskge package &mdash; BESS-KGE  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="besskge" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            BESS-KGE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">besskge</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">besskge package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-besskge.batch_sampler">besskge.batch_sampler</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#besskge.batch_sampler.RandomShardedBatchSampler"><code class="docutils literal notranslate"><span class="pre">RandomShardedBatchSampler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.batch_sampler.RigidShardedBatchSampler"><code class="docutils literal notranslate"><span class="pre">RigidShardedBatchSampler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.batch_sampler.ShardedBatchSampler"><code class="docutils literal notranslate"><span class="pre">ShardedBatchSampler</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-besskge.bess">besskge.bess</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#besskge.bess.BessKGE"><code class="docutils literal notranslate"><span class="pre">BessKGE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.bess.EmbeddingMovingBessKGE"><code class="docutils literal notranslate"><span class="pre">EmbeddingMovingBessKGE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.bess.ScoreMovingBessKGE"><code class="docutils literal notranslate"><span class="pre">ScoreMovingBessKGE</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-besskge.dataset">besskge.dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#besskge.dataset.KGDataset"><code class="docutils literal notranslate"><span class="pre">KGDataset</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-besskge.embedding">besskge.embedding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#besskge.embedding.EmbeddingInitializer"><code class="docutils literal notranslate"><span class="pre">EmbeddingInitializer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.embedding.MarginBasedInitializer"><code class="docutils literal notranslate"><span class="pre">MarginBasedInitializer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.embedding.initialize_entity_embedding"><code class="docutils literal notranslate"><span class="pre">initialize_entity_embedding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.embedding.initialize_relation_embedding"><code class="docutils literal notranslate"><span class="pre">initialize_relation_embedding()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-besskge.loss">besskge.loss</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#besskge.loss.BaseLossFunction"><code class="docutils literal notranslate"><span class="pre">BaseLossFunction</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.loss.LogSigmoidLoss"><code class="docutils literal notranslate"><span class="pre">LogSigmoidLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.loss.MarginBasedLossFunction"><code class="docutils literal notranslate"><span class="pre">MarginBasedLossFunction</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.loss.MarginRankingLoss"><code class="docutils literal notranslate"><span class="pre">MarginRankingLoss</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-besskge.metric">besskge.metric</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#besskge.metric.BaseMetric"><code class="docutils literal notranslate"><span class="pre">BaseMetric</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.metric.Evaluation"><code class="docutils literal notranslate"><span class="pre">Evaluation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.metric.HitsAtK"><code class="docutils literal notranslate"><span class="pre">HitsAtK</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.metric.ReciprocalRank"><code class="docutils literal notranslate"><span class="pre">ReciprocalRank</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-besskge.negative_sampler">besskge.negative_sampler</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#besskge.negative_sampler.RandomShardedNegativeSampler"><code class="docutils literal notranslate"><span class="pre">RandomShardedNegativeSampler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.negative_sampler.ShardedNegativeSampler"><code class="docutils literal notranslate"><span class="pre">ShardedNegativeSampler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.negative_sampler.TripleBasedShardedNegativeSampler"><code class="docutils literal notranslate"><span class="pre">TripleBasedShardedNegativeSampler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.negative_sampler.TypeBasedShardedNegativeSampler"><code class="docutils literal notranslate"><span class="pre">TypeBasedShardedNegativeSampler</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-besskge.scoring">besskge.scoring</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#besskge.scoring.BaseScoreFunction"><code class="docutils literal notranslate"><span class="pre">BaseScoreFunction</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.scoring.DistanceBasedScoreFunction"><code class="docutils literal notranslate"><span class="pre">DistanceBasedScoreFunction</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.scoring.TransE"><code class="docutils literal notranslate"><span class="pre">TransE</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-besskge.sharding">besskge.sharding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#besskge.sharding.PartitionedTripleSet"><code class="docutils literal notranslate"><span class="pre">PartitionedTripleSet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#besskge.sharding.Sharding"><code class="docutils literal notranslate"><span class="pre">Sharding</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-besskge.utils">besskge.utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#besskge.utils.gather_indices"><code class="docutils literal notranslate"><span class="pre">gather_indices()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-besskge">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BESS-KGE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">besskge</a></li>
      <li class="breadcrumb-item active">besskge package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/besskge.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="besskge-package">
<h1>besskge package<a class="headerlink" href="#besskge-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-besskge.batch_sampler">
<span id="besskge-batch-sampler"></span><h2>besskge.batch_sampler<a class="headerlink" href="#module-besskge.batch_sampler" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="besskge.batch_sampler.RandomShardedBatchSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.batch_sampler.</span></span><span class="sig-name descname"><span class="pre">RandomShardedBatchSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">partitioned_triple_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shard_bs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batches_per_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hrt_freq_weighting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duplicate_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_triple_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/batch_sampler.html#RandomShardedBatchSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.batch_sampler.RandomShardedBatchSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.batch_sampler.ShardedBatchSampler" title="besskge.batch_sampler.ShardedBatchSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardedBatchSampler</span></code></a></p>
<p>Sample random indices (with replacement) from all triple partitions.
No padding of triple partitions applied.</p>
<dl class="py method">
<dt class="sig sig-object py" id="besskge.batch_sampler.RandomShardedBatchSampler.get_dataloader_sampler">
<span class="sig-name descname"><span class="pre">get_dataloader_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/batch_sampler.html#RandomShardedBatchSampler.get_dataloader_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.batch_sampler.RandomShardedBatchSampler.get_dataloader_sampler" title="Permalink to this definition"></a></dt>
<dd><p>Instantiate appropriate <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.data.Sampler</span></code> for the
<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code> to be used with the
sharded batch sampler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shuffle</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Shuffle triples at each new epoch.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dataloader sampler.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.batch_sampler.RandomShardedBatchSampler.sample_triples">
<span class="sig-name descname"><span class="pre">sample_triples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/batch_sampler.html#RandomShardedBatchSampler.sample_triples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.batch_sampler.RandomShardedBatchSampler.sample_triples" title="Permalink to this definition"></a></dt>
<dd><p>Sample positive triples in the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The batch index.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool_</span></code>]]]]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Per-partition indices of positive triples, and other relevant data.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.batch_sampler.RigidShardedBatchSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.batch_sampler.</span></span><span class="sig-name descname"><span class="pre">RigidShardedBatchSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">partitioned_triple_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shard_bs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batches_per_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hrt_freq_weighting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duplicate_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_triple_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/batch_sampler.html#RigidShardedBatchSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.batch_sampler.RigidShardedBatchSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.batch_sampler.ShardedBatchSampler" title="besskge.batch_sampler.ShardedBatchSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardedBatchSampler</span></code></a></p>
<p>At each call, sample triples with same specified indices from all triple partitions,
repeating triples in shorter ones to pad to same length.
Returns mask to identify padding triples.</p>
<dl class="py method">
<dt class="sig sig-object py" id="besskge.batch_sampler.RigidShardedBatchSampler.sample_triples">
<span class="sig-name descname"><span class="pre">sample_triples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/batch_sampler.html#RigidShardedBatchSampler.sample_triples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.batch_sampler.RigidShardedBatchSampler.sample_triples" title="Permalink to this definition"></a></dt>
<dd><p>Sample positive triples in the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The batch index.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool_</span></code>]]]]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Per-partition indices of positive triples, and other relevant data.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.batch_sampler.ShardedBatchSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.batch_sampler.</span></span><span class="sig-name descname"><span class="pre">ShardedBatchSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">partitioned_triple_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shard_bs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batches_per_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hrt_freq_weighting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duplicate_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_triple_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/batch_sampler.html#ShardedBatchSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.batch_sampler.ShardedBatchSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for sharded batch sampler.</p>
<dl class="py method">
<dt class="sig sig-object py" id="besskge.batch_sampler.ShardedBatchSampler.get_dataloader">
<span class="sig-name descname"><span class="pre">get_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">persistent_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/batch_sampler.html#ShardedBatchSampler.get_dataloader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.batch_sampler.ShardedBatchSampler.get_dataloader" title="Permalink to this definition"></a></dt>
<dd><p>Instantiate appropriate <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code>
to iterate over the batch sampler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shuffle</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Shuffle triples at each new epoch, defaults to True.</p></li>
<li><p><strong>num_workers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – see <code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader.__init__()</span></code>, defaults to 0.</p></li>
<li><p><strong>persistent_workers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – see <code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader.__init__()</span></code>, defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dataloader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.batch_sampler.ShardedBatchSampler.get_dataloader_sampler">
<span class="sig-name descname"><span class="pre">get_dataloader_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shuffle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/batch_sampler.html#ShardedBatchSampler.get_dataloader_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.batch_sampler.ShardedBatchSampler.get_dataloader_sampler" title="Permalink to this definition"></a></dt>
<dd><p>Instantiate appropriate <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.data.Sampler</span></code> for the
<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code> to be used with the
sharded batch sampler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>shuffle</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Shuffle triples at each new epoch.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The dataloader sampler.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.batch_sampler.ShardedBatchSampler.sample_triples">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample_triples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/batch_sampler.html#ShardedBatchSampler.sample_triples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.batch_sampler.ShardedBatchSampler.sample_triples" title="Permalink to this definition"></a></dt>
<dd><p>Sample positive triples in the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – The batch index.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool_</span></code>]]]]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Per-partition indices of positive triples, and other relevant data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.batch_sampler.ShardedBatchSampler.worker_init_fn">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">worker_init_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worker_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/batch_sampler.html#ShardedBatchSampler.worker_init_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.batch_sampler.ShardedBatchSampler.worker_init_fn" title="Permalink to this definition"></a></dt>
<dd><p>Worker intialization function to be passed to
<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>worker_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Worker ID.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-besskge.bess">
<span id="besskge-bess"></span><h2>besskge.bess<a class="headerlink" href="#module-besskge.bess" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="besskge.bess.BessKGE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.bess.</span></span><span class="sig-name descname"><span class="pre">BessKGE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sharding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_relation_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity_intializer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation_intializer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/bess.html#BessKGE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.BessKGE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Base class for distributed training and inference of KGE models, using
the distribution framework BESS […].
To be used in combination with a batch sampler based on a
“ht_shardpair”-partitioned triple set.</p>
<dl class="py method">
<dt class="sig sig-object py" id="besskge.bess.BessKGE.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triple_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/bess.html#BessKGE.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.BessKGE.forward" title="Permalink to this definition"></a></dt>
<dd><p>Forward step, comprising of four phases:
1) Gather relevant embeddings from local memory;
2) Share embeddings with other devices through collective operators;
3) Score positive and negative triples;
4) Compute loss/metrics.
Each device scores n_shard * positive_per_partition positive triples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (n_shard, positive_per_partition)
Head indices.</p></li>
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (n_shard, positive_per_partition)
Relation indices.</p></li>
<li><p><strong>tail</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (n_shard, positive_per_partition)
Tail indices.</p></li>
<li><p><strong>negative</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (n_shard, B, n_negative)
Indices of negative entities,
with B = 1 or n_shard * positive_per_partition.</p></li>
<li><p><strong>triple_weight</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]) – shape: (n_shard * positive_per_partition,) or ()
Weights of positive triples.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Microbatch loss, scores, metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.bess.BessKGE.score_batch">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">score_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/bess.html#BessKGE.score_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.BessKGE.score_batch" title="Permalink to this definition"></a></dt>
<dd><p>Compute positive and negative scores for the microbatch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>tail</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>negative</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>positive (shape: (n_shard * positive_per_partition,))
and negative (shape: (n_shard * positive_per_partition, n_negative))
scores of the microbatch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.bess.BessKGE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.bess.BessKGE.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.bess.EmbeddingMovingBessKGE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.bess.</span></span><span class="sig-name descname"><span class="pre">EmbeddingMovingBessKGE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sharding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_relation_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity_intializer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation_intializer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/bess.html#EmbeddingMovingBessKGE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.EmbeddingMovingBessKGE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.bess.BessKGE" title="besskge.bess.BessKGE"><code class="xref py py-class docutils literal notranslate"><span class="pre">BessKGE</span></code></a></p>
<p>Compute negative scores on the shard where the positive triples
are scored (i.e. head shard).
This requires moving embedding of negative entities between shards,
which can be done with a single AllToAll collective.</p>
<p>Each triple is scored against a total number of entities equal to
<cite>n_negative * n_shard</cite> if negative sample sharing is disabled, otherwise
<cite>n_negative * n_shard * B</cite> (see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a>) for “h”, “t”
corruption scheme, <cite>n_negative * n_shard * B // (B &gt; 1 ? 2 : 1)</cite> for “ht”.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.bess.EmbeddingMovingBessKGE.embedding_size">
<span class="sig-name descname"><span class="pre">embedding_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#besskge.bess.EmbeddingMovingBessKGE.embedding_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.bess.EmbeddingMovingBessKGE.score_batch">
<span class="sig-name descname"><span class="pre">score_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/bess.html#EmbeddingMovingBessKGE.score_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.EmbeddingMovingBessKGE.score_batch" title="Permalink to this definition"></a></dt>
<dd><p>Compute positive and negative scores for the microbatch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>tail</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>negative</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>positive (shape: (n_shard * positive_per_partition,))
and negative (shape: (n_shard * positive_per_partition, n_negative))
scores of the microbatch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.bess.EmbeddingMovingBessKGE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.bess.EmbeddingMovingBessKGE.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.bess.ScoreMovingBessKGE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.bess.</span></span><span class="sig-name descname"><span class="pre">ScoreMovingBessKGE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sharding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_relation_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity_intializer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation_intializer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/bess.html#ScoreMovingBessKGE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.ScoreMovingBessKGE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.bess.BessKGE" title="besskge.bess.BessKGE"><code class="xref py py-class docutils literal notranslate"><span class="pre">BessKGE</span></code></a></p>
<p>Compute negative scores on the shard where the negative entities are stored.
This avoids moving embeddings between shards (convenient when the number of
negative entities is very large, e.g. when scoring queries against all entities
in the KG, or when using large embedding size).</p>
<p>AllGather collectives are required to replicate queries on all devices, so that
they can be scored against the local negative entities. An AllToAll collective
is then used to send the scores back to the correct device.</p>
<p>For the number of negative samples scored for each triple, see the corresponding
value documented in <a class="reference internal" href="#besskge.bess.EmbeddingMovingBessKGE" title="besskge.bess.EmbeddingMovingBessKGE"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmbeddingMovingBessKGE</span></code></a> and, if using negative
sample sharing, multiply that by n_shard.</p>
<p>Does not support local sampling.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.bess.ScoreMovingBessKGE.embedding_size">
<span class="sig-name descname"><span class="pre">embedding_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#besskge.bess.ScoreMovingBessKGE.embedding_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.bess.ScoreMovingBessKGE.score_batch">
<span class="sig-name descname"><span class="pre">score_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/bess.html#ScoreMovingBessKGE.score_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.bess.ScoreMovingBessKGE.score_batch" title="Permalink to this definition"></a></dt>
<dd><p>Compute positive and negative scores for the microbatch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>tail</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
<li><p><strong>negative</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – see <a class="reference internal" href="#besskge.bess.BessKGE.forward" title="besskge.bess.BessKGE.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BessKGE.forward()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>positive (shape: (n_shard * positive_per_partition,))
and negative (shape: (n_shard * positive_per_partition, n_negative))
scores of the microbatch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.bess.ScoreMovingBessKGE.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.bess.ScoreMovingBessKGE.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-besskge.dataset">
<span id="besskge-dataset"></span><h2>besskge.dataset<a class="headerlink" href="#module-besskge.dataset" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="besskge.dataset.KGDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.dataset.</span></span><span class="sig-name descname"><span class="pre">KGDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_entity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_relation_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_offsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg_tails</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/dataset.html#KGDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.dataset.KGDataset" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents a complete knowledge graph dataset of (head, relation, tail) triples.</p>
<dl class="py method">
<dt class="sig sig-object py" id="besskge.dataset.KGDataset.build_biokg">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">build_biokg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/dataset.html#KGDataset.build_biokg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.dataset.KGDataset.build_biokg" title="Permalink to this definition"></a></dt>
<dd><p>Build the OGB-BioKG dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>root</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – Path to dataset.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#besskge.dataset.KGDataset" title="besskge.dataset.KGDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">KGDataset</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>OGB-BioKG KGDataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.dataset.KGDataset.entity_dict">
<span class="sig-name descname"><span class="pre">entity_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]]</span></em><a class="headerlink" href="#besskge.dataset.KGDataset.entity_dict" title="Permalink to this definition"></a></dt>
<dd><p>Entity labels by ID; str[n_entity]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="besskge.dataset.KGDataset.ht_types">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ht_types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">int32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#besskge.dataset.KGDataset.ht_types" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.dataset.KGDataset.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/dataset.html#KGDataset.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.dataset.KGDataset.load" title="Permalink to this definition"></a></dt>
<dd><p>Load a <a class="reference internal" href="#besskge.dataset.KGDataset" title="besskge.dataset.KGDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">KGDataset</span></code></a> saved with <a class="reference internal" href="#besskge.dataset.KGDataset.save" title="besskge.dataset.KGDataset.save"><code class="xref py py-func docutils literal notranslate"><span class="pre">KGDataset.save()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – Path to saved <a class="reference internal" href="#besskge.dataset.KGDataset" title="besskge.dataset.KGDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">KGDataset</span></code></a>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#besskge.dataset.KGDataset" title="besskge.dataset.KGDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">KGDataset</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The saved <a class="reference internal" href="#besskge.dataset.KGDataset" title="besskge.dataset.KGDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">KGDataset</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.dataset.KGDataset.n_entity">
<span class="sig-name descname"><span class="pre">n_entity</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#besskge.dataset.KGDataset.n_entity" title="Permalink to this definition"></a></dt>
<dd><p>Number of entities (nodes) in the KG</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.dataset.KGDataset.n_relation_type">
<span class="sig-name descname"><span class="pre">n_relation_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#besskge.dataset.KGDataset.n_relation_type" title="Permalink to this definition"></a></dt>
<dd><p>Number of relation types (edge labels) in the KG</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.dataset.KGDataset.neg_heads">
<span class="sig-name descname"><span class="pre">neg_heads</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code><span class="pre">]]]]</span></em><a class="headerlink" href="#besskge.dataset.KGDataset.neg_heads" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.dataset.KGDataset.neg_tails">
<span class="sig-name descname"><span class="pre">neg_tails</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code><span class="pre">]]]]</span></em><a class="headerlink" href="#besskge.dataset.KGDataset.neg_tails" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.dataset.KGDataset.relation_dict">
<span class="sig-name descname"><span class="pre">relation_dict</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">]]</span></em><a class="headerlink" href="#besskge.dataset.KGDataset.relation_dict" title="Permalink to this definition"></a></dt>
<dd><p>Relation type labels by ID; str[n_relation_type]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.dataset.KGDataset.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/dataset.html#KGDataset.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.dataset.KGDataset.save" title="Permalink to this definition"></a></dt>
<dd><p>Save dataset to .pkl.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> – Path to output file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.dataset.KGDataset.triples">
<span class="sig-name descname"><span class="pre">triples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code><span class="pre">]]]</span></em><a class="headerlink" href="#besskge.dataset.KGDataset.triples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.dataset.KGDataset.type_offsets">
<span class="sig-name descname"><span class="pre">type_offsets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code><span class="pre">]]</span></em><a class="headerlink" href="#besskge.dataset.KGDataset.type_offsets" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-besskge.embedding">
<span id="besskge-embedding"></span><h2>besskge.embedding<a class="headerlink" href="#module-besskge.embedding" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="besskge.embedding.EmbeddingInitializer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.embedding.</span></span><span class="sig-name descname"><span class="pre">EmbeddingInitializer</span></span><a class="reference internal" href="_modules/besskge/embedding.html#EmbeddingInitializer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.embedding.EmbeddingInitializer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for custom embedding initialization scheme.</p>
<dl class="py method">
<dt class="sig sig-object py" id="besskge.embedding.EmbeddingInitializer.initialize">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding_table</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/embedding.html#EmbeddingInitializer.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.embedding.EmbeddingInitializer.initialize" title="Permalink to this definition"></a></dt>
<dd><p>Initialize embedding table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>embedding_table</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Parameter</span></code>) – The embedding table to initialize (in-place)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.embedding.MarginBasedInitializer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.embedding.</span></span><span class="sig-name descname"><span class="pre">MarginBasedInitializer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">margin</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/embedding.html#MarginBasedInitializer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.embedding.MarginBasedInitializer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.embedding.EmbeddingInitializer" title="besskge.embedding.EmbeddingInitializer"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmbeddingInitializer</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="besskge.embedding.MarginBasedInitializer.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding_table</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/embedding.html#MarginBasedInitializer.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.embedding.MarginBasedInitializer.initialize" title="Permalink to this definition"></a></dt>
<dd><p>Initialize embedding table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>embedding_table</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Parameter</span></code>) – The embedding table to initialize (in-place)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="besskge.embedding.initialize_entity_embedding">
<span class="sig-prename descclassname"><span class="pre">besskge.embedding.</span></span><span class="sig-name descname"><span class="pre">initialize_entity_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initializer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/embedding.html#initialize_entity_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.embedding.initialize_entity_embedding" title="Permalink to this definition"></a></dt>
<dd><p>Initialize entity embedding table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initializer</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <a class="reference internal" href="#besskge.embedding.EmbeddingInitializer" title="besskge.embedding.EmbeddingInitializer"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmbeddingInitializer</span></code></a>]) – Embedding table or embedding intializer. If providing
embedding table, this can either be sharded
(shape: (n_shard, max_entity_per_shard, embedding_size))
or unsharded (shape: (n_entity, embedding_size)).</p></li>
<li><p><strong>sharding</strong> (<a class="reference internal" href="#besskge.sharding.Sharding" title="besskge.sharding.Sharding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sharding</span></code></a>) – Entity sharding.</p></li>
<li><p><strong>embedding_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Entity embedding size. Can be omitted if passing
embedding table.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameter</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Entity embedding table.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="besskge.embedding.initialize_relation_embedding">
<span class="sig-prename descclassname"><span class="pre">besskge.embedding.</span></span><span class="sig-name descname"><span class="pre">initialize_relation_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initializer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_relation_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/embedding.html#initialize_relation_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.embedding.initialize_relation_embedding" title="Permalink to this definition"></a></dt>
<dd><p>Initialize relation embedding table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initializer</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <a class="reference internal" href="#besskge.embedding.EmbeddingInitializer" title="besskge.embedding.EmbeddingInitializer"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmbeddingInitializer</span></code></a>]) – Embedding table or embedding intializer.</p></li>
<li><p><strong>n_relation_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of relation types.</p></li>
<li><p><strong>embedding_size</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Relation embedding size. Can be omitted if passing
embedding table.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameter</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Relation embedding table.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-besskge.loss">
<span id="besskge-loss"></span><h2>besskge.loss<a class="headerlink" href="#module-besskge.loss" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="besskge.loss.BaseLossFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.loss.</span></span><span class="sig-name descname"><span class="pre">BaseLossFunction</span></span><a class="reference internal" href="_modules/besskge/loss.html#BaseLossFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.loss.BaseLossFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for a loss function.</p>
<dl class="py method">
<dt class="sig sig-object py" id="besskge.loss.BaseLossFunction.get_negative_weights">
<span class="sig-name descname"><span class="pre">get_negative_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">negative_score</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/loss.html#BaseLossFunction.get_negative_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.loss.BaseLossFunction.get_negative_weights" title="Permalink to this definition"></a></dt>
<dd><p>Construct weights of negative samples, based on their score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>negative_score</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – : (batch_size, n_negative)
Scores of negative samples.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>shape: (batch_size, n_negative)</dt><dd><p>if <a class="reference internal" href="#besskge.loss.BaseLossFunction.negative_adversarial_sampling" title="besskge.loss.BaseLossFunction.negative_adversarial_sampling"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BaseLossFunction.negative_adversarial_sampling</span></code></a> else ()</p>
</dd>
</dl>
<p>Weights of negative samples.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.loss.BaseLossFunction.negative_adversarial_sampling">
<span class="sig-name descname"><span class="pre">negative_adversarial_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.loss.BaseLossFunction.negative_adversarial_sampling" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.loss.BaseLossFunction.negative_adversarial_scale">
<span class="sig-name descname"><span class="pre">negative_adversarial_scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><a class="headerlink" href="#besskge.loss.BaseLossFunction.negative_adversarial_scale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.loss.LogSigmoidLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.loss.</span></span><span class="sig-name descname"><span class="pre">LogSigmoidLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">margin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_adversarial_sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_adversarial_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/loss.html#LogSigmoidLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.loss.LogSigmoidLoss" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.loss.MarginBasedLossFunction" title="besskge.loss.MarginBasedLossFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">MarginBasedLossFunction</span></code></a></p>
<p>The log-sigmoid loss function (see […]).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.loss.LogSigmoidLoss.negative_adversarial_sampling">
<span class="sig-name descname"><span class="pre">negative_adversarial_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.loss.LogSigmoidLoss.negative_adversarial_sampling" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.loss.LogSigmoidLoss.negative_adversarial_scale">
<span class="sig-name descname"><span class="pre">negative_adversarial_scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><a class="headerlink" href="#besskge.loss.LogSigmoidLoss.negative_adversarial_scale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.loss.MarginBasedLossFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.loss.</span></span><span class="sig-name descname"><span class="pre">MarginBasedLossFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">margin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_adversarial_sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_adversarial_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/loss.html#MarginBasedLossFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.loss.MarginBasedLossFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.loss.BaseLossFunction" title="besskge.loss.BaseLossFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLossFunction</span></code></a></p>
<p>Base class for margin-based loss functions.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.loss.MarginBasedLossFunction.negative_adversarial_sampling">
<span class="sig-name descname"><span class="pre">negative_adversarial_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.loss.MarginBasedLossFunction.negative_adversarial_sampling" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.loss.MarginBasedLossFunction.negative_adversarial_scale">
<span class="sig-name descname"><span class="pre">negative_adversarial_scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><a class="headerlink" href="#besskge.loss.MarginBasedLossFunction.negative_adversarial_scale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.loss.MarginRankingLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.loss.</span></span><span class="sig-name descname"><span class="pre">MarginRankingLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">margin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_adversarial_sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_adversarial_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/loss.html#MarginRankingLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.loss.MarginRankingLoss" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.loss.MarginBasedLossFunction" title="besskge.loss.MarginBasedLossFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">MarginBasedLossFunction</span></code></a></p>
<p>The margin ranking (or pairwise hinge) loss function (see […]).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.loss.MarginRankingLoss.negative_adversarial_sampling">
<span class="sig-name descname"><span class="pre">negative_adversarial_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.loss.MarginRankingLoss.negative_adversarial_sampling" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.loss.MarginRankingLoss.negative_adversarial_scale">
<span class="sig-name descname"><span class="pre">negative_adversarial_scale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><a class="headerlink" href="#besskge.loss.MarginRankingLoss.negative_adversarial_scale" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-besskge.metric">
<span id="besskge-metric"></span><h2>besskge.metric<a class="headerlink" href="#module-besskge.metric" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="besskge.metric.BaseMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.metric.</span></span><span class="sig-name descname"><span class="pre">BaseMetric</span></span><a class="reference internal" href="_modules/besskge/metric.html#BaseMetric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.metric.BaseMetric" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.metric.BaseMetric.reduction">
<span class="sig-name descname"><span class="pre">reduction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code><span class="pre">[[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code><span class="pre">],</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code><span class="pre">]</span></em><a class="headerlink" href="#besskge.metric.BaseMetric.reduction" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.metric.Evaluation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.metric.</span></span><span class="sig-name descname"><span class="pre">Evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'average'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worst_rank_infty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/metric.html#Evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.metric.Evaluation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A module for computing link prediction metrics.</p>
<dl class="py method">
<dt class="sig sig-object py" id="besskge.metric.Evaluation.metrics_from_indices">
<span class="sig-name descname"><span class="pre">metrics_from_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ground_truth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg_indices</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/metric.html#Evaluation.metrics_from_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.metric.Evaluation.metrics_from_indices" title="Permalink to this definition"></a></dt>
<dd><p>Compute the required metrics from the ground truth and
ORDERED negative indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ground_truth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size,)
Indices of ground truth entities for each query.</p></li>
<li><p><strong>neg_indices</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, n_negative)
Indices of top n_negative predicted entities,
ordered by decreasing likelihood. The indices
on each row are assumed to be distinct.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The batch metrics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.metric.Evaluation.metrics_from_scores">
<span class="sig-name descname"><span class="pre">metrics_from_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg_score</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/metric.html#Evaluation.metrics_from_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.metric.Evaluation.metrics_from_scores" title="Permalink to this definition"></a></dt>
<dd><p>Compute the required metrics on a batch of scores.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos_score</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size,)
Scores of positive triples.</p></li>
<li><p><strong>neg_score</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, n_negative)
Scores of negative triples.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The batch metrics.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.metric.HitsAtK">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.metric.</span></span><span class="sig-name descname"><span class="pre">HitsAtK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/metric.html#HitsAtK"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.metric.HitsAtK" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.metric.BaseMetric" title="besskge.metric.BaseMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseMetric</span></code></a></p>
<p>Hits&#64;K metric.
Returns (reduced) count of triples where the ground truth
is among the K most likely predicted entities.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.metric.HitsAtK.reduction">
<span class="sig-name descname"><span class="pre">reduction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code><span class="pre">[[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code><span class="pre">],</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code><span class="pre">]</span></em><a class="headerlink" href="#besskge.metric.HitsAtK.reduction" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.metric.ReciprocalRank">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.metric.</span></span><span class="sig-name descname"><span class="pre">ReciprocalRank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reduction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/metric.html#ReciprocalRank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.metric.ReciprocalRank" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.metric.BaseMetric" title="besskge.metric.BaseMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseMetric</span></code></a></p>
<p>Reciprocal rank (e.g. to compute MRR).
Returns (reduced) reciprocal rank of ground truth among predictions.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.metric.ReciprocalRank.reduction">
<span class="sig-name descname"><span class="pre">reduction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code><span class="pre">[[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code><span class="pre">],</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code><span class="pre">]</span></em><a class="headerlink" href="#besskge.metric.ReciprocalRank.reduction" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-besskge.negative_sampler">
<span id="besskge-negative-sampler"></span><h2>besskge.negative_sampler<a class="headerlink" href="#module-besskge.negative_sampler" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="besskge.negative_sampler.RandomShardedNegativeSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.negative_sampler.</span></span><span class="sig-name descname"><span class="pre">RandomShardedNegativeSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_negative</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corruption_scheme</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_negative_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/negative_sampler.html#RandomShardedNegativeSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.negative_sampler.RandomShardedNegativeSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.negative_sampler.ShardedNegativeSampler" title="besskge.negative_sampler.ShardedNegativeSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardedNegativeSampler</span></code></a></p>
<p>Sample random negative entities for each triple in batch.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.negative_sampler.RandomShardedNegativeSampler.corruption_scheme">
<span class="sig-name descname"><span class="pre">corruption_scheme</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#besskge.negative_sampler.RandomShardedNegativeSampler.corruption_scheme" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.negative_sampler.RandomShardedNegativeSampler.flat_negative_format">
<span class="sig-name descname"><span class="pre">flat_negative_format</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.negative_sampler.RandomShardedNegativeSampler.flat_negative_format" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.negative_sampler.RandomShardedNegativeSampler.local_sampling">
<span class="sig-name descname"><span class="pre">local_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.negative_sampler.RandomShardedNegativeSampler.local_sampling" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.negative_sampler.ShardedNegativeSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.negative_sampler.</span></span><span class="sig-name descname"><span class="pre">ShardedNegativeSampler</span></span><a class="reference internal" href="_modules/besskge/negative_sampler.html#ShardedNegativeSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.negative_sampler.ShardedNegativeSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for sharded negative sampler.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.negative_sampler.ShardedNegativeSampler.corruption_scheme">
<span class="sig-name descname"><span class="pre">corruption_scheme</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#besskge.negative_sampler.ShardedNegativeSampler.corruption_scheme" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.negative_sampler.ShardedNegativeSampler.flat_negative_format">
<span class="sig-name descname"><span class="pre">flat_negative_format</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.negative_sampler.ShardedNegativeSampler.flat_negative_format" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.negative_sampler.ShardedNegativeSampler.local_sampling">
<span class="sig-name descname"><span class="pre">local_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.negative_sampler.ShardedNegativeSampler.local_sampling" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.negative_sampler.TripleBasedShardedNegativeSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.negative_sampler.</span></span><span class="sig-name descname"><span class="pre">TripleBasedShardedNegativeSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">negative_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_tails</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corruption_scheme</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sort_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/negative_sampler.html#TripleBasedShardedNegativeSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.negative_sampler.TripleBasedShardedNegativeSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.negative_sampler.ShardedNegativeSampler" title="besskge.negative_sampler.ShardedNegativeSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShardedNegativeSampler</span></code></a></p>
<p>Return (possibly triple-specific) predetermined negative entities.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.negative_sampler.TripleBasedShardedNegativeSampler.corruption_scheme">
<span class="sig-name descname"><span class="pre">corruption_scheme</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#besskge.negative_sampler.TripleBasedShardedNegativeSampler.corruption_scheme" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.negative_sampler.TripleBasedShardedNegativeSampler.flat_negative_format">
<span class="sig-name descname"><span class="pre">flat_negative_format</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.negative_sampler.TripleBasedShardedNegativeSampler.flat_negative_format" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.negative_sampler.TripleBasedShardedNegativeSampler.local_sampling">
<span class="sig-name descname"><span class="pre">local_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.negative_sampler.TripleBasedShardedNegativeSampler.local_sampling" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.negative_sampler.TripleBasedShardedNegativeSampler.pad_negatives">
<span class="sig-name descname"><span class="pre">pad_negatives</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">negatives</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shard_counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padded_shard_length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/negative_sampler.html#TripleBasedShardedNegativeSampler.pad_negatives"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.negative_sampler.TripleBasedShardedNegativeSampler.pad_negatives" title="Permalink to this definition"></a></dt>
<dd><p>Divide negatives based on shard and pad lists to same length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>negatives</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code>]]) – shape: (N, n_negative)
Negative entities, each row already sorted in shard order
(N = 1, n_triple).</p></li>
<li><p><strong>shard_counts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code>]]) – shape: (N, n_shard)
Number of negatives per shard.</p></li>
<li><p><strong>padded_shard_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The size to which each shard list is to be padded.</p></li>
</ul>
</dd>
<dt class="field-even">Return padded_negatives<span class="colon">:</span></dt>
<dd class="field-even"><p>shape: (N, n_shard, padded_shard_length)
The padded shard lists of negatives.</p>
</dd>
<dt class="field-odd">Return mask<span class="colon">:</span></dt>
<dd class="field-odd"><p>shape: (N, n_negative)
Indices of true negatives in <cite>padded_negatives.view(N,-1)</cite>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.negative_sampler.TripleBasedShardedNegativeSampler.shard_negatives">
<span class="sig-name descname"><span class="pre">shard_negatives</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">negatives</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/negative_sampler.html#TripleBasedShardedNegativeSampler.shard_negatives"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.negative_sampler.TripleBasedShardedNegativeSampler.shard_negatives" title="Permalink to this definition"></a></dt>
<dd><p>Split negative entities into correpsonding shards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>negatives</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code>]]) – shape: (N, n_negatives)
Negative entities to shard (N = 1, n_triple).</p>
</dd>
<dt class="field-even">Return shard_neg_counts<span class="colon">:</span></dt>
<dd class="field-even"><p>shape: (N, n_shard)
Number of negative entities per shard.</p>
</dd>
<dt class="field-odd">Return sort_neg_idx<span class="colon">:</span></dt>
<dd class="field-odd"><p>shape: (N, n_negatives)
Sorting index to cluster negatives in shard order.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code>]]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.negative_sampler.TypeBasedShardedNegativeSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.negative_sampler.</span></span><span class="sig-name descname"><span class="pre">TypeBasedShardedNegativeSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">triple_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_negative</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corruption_scheme</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_sampling</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/negative_sampler.html#TypeBasedShardedNegativeSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.negative_sampler.TypeBasedShardedNegativeSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.negative_sampler.RandomShardedNegativeSampler" title="besskge.negative_sampler.RandomShardedNegativeSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomShardedNegativeSampler</span></code></a></p>
<p>Corrupt entities with entities of the same type.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.negative_sampler.TypeBasedShardedNegativeSampler.corruption_scheme">
<span class="sig-name descname"><span class="pre">corruption_scheme</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#besskge.negative_sampler.TypeBasedShardedNegativeSampler.corruption_scheme" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.negative_sampler.TypeBasedShardedNegativeSampler.flat_negative_format">
<span class="sig-name descname"><span class="pre">flat_negative_format</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.negative_sampler.TypeBasedShardedNegativeSampler.flat_negative_format" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.negative_sampler.TypeBasedShardedNegativeSampler.local_sampling">
<span class="sig-name descname"><span class="pre">local_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.negative_sampler.TypeBasedShardedNegativeSampler.local_sampling" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-besskge.scoring">
<span id="besskge-scoring"></span><h2>besskge.scoring<a class="headerlink" href="#module-besskge.scoring" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="besskge.scoring.BaseScoreFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.scoring.</span></span><span class="sig-name descname"><span class="pre">BaseScoreFunction</span></span><a class="reference internal" href="_modules/besskge/scoring.html#BaseScoreFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.scoring.BaseScoreFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for scoring functions.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.scoring.BaseScoreFunction.negative_sample_sharing">
<span class="sig-name descname"><span class="pre">negative_sample_sharing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.scoring.BaseScoreFunction.negative_sample_sharing" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.scoring.BaseScoreFunction.score_heads">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">score_heads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/scoring.html#BaseScoreFunction.score_heads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.scoring.BaseScoreFunction.score_heads" title="Permalink to this definition"></a></dt>
<dd><p>Score sets of head entities against fixed (r,t) queries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (B, n_heads, embedding_size) with B = 1, batch_size
Embeddings of head entities.</p></li>
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Embeddings of relation types in batch.</p></li>
<li><p><strong>tail</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Embedding of tail entities in batch.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>shape: (batch_size, B * n_heads) if</dt><dd><p><a class="reference internal" href="#besskge.scoring.BaseScoreFunction.negative_sample_sharing" title="besskge.scoring.BaseScoreFunction.negative_sample_sharing"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BaseScoreFunction.negative_sample_sharing</span></code></a>
else (batch_size, n_heads)</p>
</dd>
</dl>
<p>Scores of broadcasted triples.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.scoring.BaseScoreFunction.score_tails">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">score_tails</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/scoring.html#BaseScoreFunction.score_tails"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.scoring.BaseScoreFunction.score_tails" title="Permalink to this definition"></a></dt>
<dd><p>Score sets of tail entities against fixed (h,r) queries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Embeddings of head entities in batch.</p></li>
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Embeddings of relation types in batch.</p></li>
<li><p><strong>tail</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (B, n_tails, embedding_size) with B = 1, batch_size
Embedding of tail entities.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>shape: (batch_size, B * n_tails) if</dt><dd><p><a class="reference internal" href="#besskge.scoring.BaseScoreFunction.negative_sample_sharing" title="besskge.scoring.BaseScoreFunction.negative_sample_sharing"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BaseScoreFunction.negative_sample_sharing</span></code></a>
else (batch_size, n_tails)</p>
</dd>
</dl>
<p>Scores of broadcasted triples.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.scoring.BaseScoreFunction.score_triple">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">score_triple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/scoring.html#BaseScoreFunction.score_triple"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.scoring.BaseScoreFunction.score_triple" title="Permalink to this definition"></a></dt>
<dd><p>Score (h,r,t) triples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Embeddings of head entities in batch.</p></li>
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Embeddings of relation types in batch.</p></li>
<li><p><strong>tail</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Embedding of tail entities in batch.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>shape (batch_size,)
Scores of batch triples.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.scoring.DistanceBasedScoreFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.scoring.</span></span><span class="sig-name descname"><span class="pre">DistanceBasedScoreFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">negative_sample_sharing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scoring_norm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/scoring.html#DistanceBasedScoreFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.scoring.DistanceBasedScoreFunction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.scoring.BaseScoreFunction" title="besskge.scoring.BaseScoreFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseScoreFunction</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for distance-based scoring functions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="besskge.scoring.DistanceBasedScoreFunction.broadcasted_score">
<span class="sig-name descname"><span class="pre">broadcasted_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/scoring.html#DistanceBasedScoreFunction.broadcasted_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.scoring.DistanceBasedScoreFunction.broadcasted_score" title="Permalink to this definition"></a></dt>
<dd><p>Broadcasted scores of queries against sets of negative entities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Batch queries.</p></li>
<li><p><strong>v2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (B, n_neg, embedding_size) with B = 1, batch_size
Negative embeddings to score against queries.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>shape: (batch_size, B * n_neg) if
<a class="reference internal" href="#besskge.scoring.BaseScoreFunction.negative_sample_sharing" title="besskge.scoring.BaseScoreFunction.negative_sample_sharing"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BaseScoreFunction.negative_sample_sharing</span></code></a>
else (batch_size, n_neg)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.scoring.DistanceBasedScoreFunction.distance_matrix">
<span class="sig-name descname"><span class="pre">distance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/scoring.html#DistanceBasedScoreFunction.distance_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.scoring.DistanceBasedScoreFunction.distance_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Broadcasted pairwise distance between two collections of vectors.
Computes p-norm reduction along trailing dimension of
<cite>tensor1[:, None, :] - tensor2[None, :, :]</cite> without materializing the
intermediate broadcasted difference, for memory optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (outer1, K)
First collection.</p></li>
<li><p><strong>v2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (outer2, K)
Second collection.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>shape: (outer1, outer2)
Broadcasted pairwise p-distance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.scoring.DistanceBasedScoreFunction.negative_sample_sharing">
<span class="sig-name descname"><span class="pre">negative_sample_sharing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.scoring.DistanceBasedScoreFunction.negative_sample_sharing" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.scoring.DistanceBasedScoreFunction.reduce_norm">
<span class="sig-name descname"><span class="pre">reduce_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/scoring.html#DistanceBasedScoreFunction.reduce_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.scoring.DistanceBasedScoreFunction.reduce_norm" title="Permalink to this definition"></a></dt>
<dd><p>p-norm reduction along embedding dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>v</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (<a href="#id1"><span class="problematic" id="id2">*</span></a>, embedding_size)
The tensor to reduce.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>shape: (<a href="#id3"><span class="problematic" id="id4">*</span></a>,)
p-norm reduction.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.scoring.TransE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.scoring.</span></span><span class="sig-name descname"><span class="pre">TransE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">negative_sample_sharing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scoring_norm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/scoring.html#TransE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.scoring.TransE" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#besskge.scoring.DistanceBasedScoreFunction" title="besskge.scoring.DistanceBasedScoreFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistanceBasedScoreFunction</span></code></a></p>
<p>TransE scoring function (see […]).</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.scoring.TransE.negative_sample_sharing">
<span class="sig-name descname"><span class="pre">negative_sample_sharing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></em><a class="headerlink" href="#besskge.scoring.TransE.negative_sample_sharing" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.scoring.TransE.score_heads">
<span class="sig-name descname"><span class="pre">score_heads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/scoring.html#TransE.score_heads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.scoring.TransE.score_heads" title="Permalink to this definition"></a></dt>
<dd><p>Score sets of head entities against fixed (r,t) queries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (B, n_heads, embedding_size) with B = 1, batch_size
Embeddings of head entities.</p></li>
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Embeddings of relation types in batch.</p></li>
<li><p><strong>tail</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Embedding of tail entities in batch.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>shape: (batch_size, B * n_heads) if</dt><dd><p><a class="reference internal" href="#besskge.scoring.BaseScoreFunction.negative_sample_sharing" title="besskge.scoring.BaseScoreFunction.negative_sample_sharing"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BaseScoreFunction.negative_sample_sharing</span></code></a>
else (batch_size, n_heads)</p>
</dd>
</dl>
<p>Scores of broadcasted triples.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.scoring.TransE.score_tails">
<span class="sig-name descname"><span class="pre">score_tails</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/scoring.html#TransE.score_tails"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.scoring.TransE.score_tails" title="Permalink to this definition"></a></dt>
<dd><p>Score sets of tail entities against fixed (h,r) queries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Embeddings of head entities in batch.</p></li>
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Embeddings of relation types in batch.</p></li>
<li><p><strong>tail</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (B, n_tails, embedding_size) with B = 1, batch_size
Embedding of tail entities.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>shape: (batch_size, B * n_tails) if</dt><dd><p><a class="reference internal" href="#besskge.scoring.BaseScoreFunction.negative_sample_sharing" title="besskge.scoring.BaseScoreFunction.negative_sample_sharing"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BaseScoreFunction.negative_sample_sharing</span></code></a>
else (batch_size, n_tails)</p>
</dd>
</dl>
<p>Scores of broadcasted triples.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.scoring.TransE.score_triple">
<span class="sig-name descname"><span class="pre">score_triple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tail</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/scoring.html#TransE.score_triple"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.scoring.TransE.score_triple" title="Permalink to this definition"></a></dt>
<dd><p>Score (h,r,t) triples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Embeddings of head entities in batch.</p></li>
<li><p><strong>relation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Embeddings of relation types in batch.</p></li>
<li><p><strong>tail</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (batch_size, embedding_size)
Embedding of tail entities in batch.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>shape (batch_size,)
Scores of batch triples.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-besskge.sharding">
<span id="besskge-sharding"></span><h2>besskge.sharding<a class="headerlink" href="#module-besskge.sharding" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="besskge.sharding.PartitionedTripleSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.sharding.</span></span><span class="sig-name descname"><span class="pre">PartitionedTripleSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sharding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dummy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triple_counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triple_offsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triple_sort_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg_tails</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/sharding.html#PartitionedTripleSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.sharding.PartitionedTripleSet" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A partitioned collection of triples.
If <cite>partition_mode = ‘h_shard’</cite> (resp. <cite>‘t_shard’</cite>) each triple is
assigned to one of <cite>n_shard</cite> partitions based on the
shard where the head (resp. tail) entity is stored.
If <cite>partition_mode = ‘ht_shardpair’</cite>, each triple is assigned to one
of n_shard ** 2 partitions based on the shardpair (shard_h, shard_t).
Shardpairs are ordered as:
(0,0), (0,1), …, (0,n_shard-1), (1,0), …, (n_shard-1, n_shard-1).</p>
<dl class="py method">
<dt class="sig sig-object py" id="besskge.sharding.PartitionedTripleSet.create_from_dataset">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_from_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ht_shardpair'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/sharding.html#PartitionedTripleSet.create_from_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.sharding.PartitionedTripleSet.create_from_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Create a partitioned triple set from a <code class="xref py py-class docutils literal notranslate"><span class="pre">KGDataset</span></code> part.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="#besskge.dataset.KGDataset" title="besskge.dataset.KGDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">KGDataset</span></code></a>) – KG dataset.</p></li>
<li><p><strong>part</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The dataset part to shard.</p></li>
<li><p><strong>sharding</strong> (<a class="reference internal" href="#besskge.sharding.Sharding" title="besskge.sharding.Sharding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sharding</span></code></a>) – The entity sharding to use.</p></li>
<li><p><strong>partition_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The triple partition mode, to choose between
“h_shard”, “t_shard”, “ht_shardpair”.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#besskge.sharding.PartitionedTripleSet" title="besskge.sharding.PartitionedTripleSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartitionedTripleSet</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Partitioned set of triples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.sharding.PartitionedTripleSet.create_from_queries">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_from_queries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/sharding.html#PartitionedTripleSet.create_from_queries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.sharding.PartitionedTripleSet.create_from_queries" title="Permalink to this definition"></a></dt>
<dd><p>Create a partitioned triple set from a set of (h,r,?) or (?,r,t) queries.
Pairs are completed to triples by adding dummy entities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="#besskge.dataset.KGDataset" title="besskge.dataset.KGDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">KGDataset</span></code></a>) – KG dataset.</p></li>
<li><p><strong>sharding</strong> (<a class="reference internal" href="#besskge.sharding.Sharding" title="besskge.sharding.Sharding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sharding</span></code></a>) – The entity sharding to use.</p></li>
<li><p><strong>queries</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code>]]) – shape: (n_query, 2)
The set of (h, r) or (r, t) queries.
Global IDs for entities/relations.</p></li>
<li><p><strong>query_mode</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – “hr” for (h,r,?) queries, “rt” for (?,r,t) queries.</p></li>
<li><p><strong>negative</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code>]]]) – shape: (N, n_negative)
Global IDs of negative entities to score against each query,
query-specific (N=n_query) or same for all queries (N=1).
Defaults to None (i.e. score queries against all entities in the graph).</p></li>
<li><p><strong>negative_type</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Score queries only against entities of a specific type.
Defaults to None (i.e. score queries against entities of any type).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#besskge.sharding.PartitionedTripleSet" title="besskge.sharding.PartitionedTripleSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartitionedTripleSet</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Partitioned set of queries (with dummy h/t completion).</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.PartitionedTripleSet.dummy">
<span class="sig-name descname"><span class="pre">dummy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#besskge.sharding.PartitionedTripleSet.dummy" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.PartitionedTripleSet.neg_heads">
<span class="sig-name descname"><span class="pre">neg_heads</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code><span class="pre">]]]</span></em><a class="headerlink" href="#besskge.sharding.PartitionedTripleSet.neg_heads" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.PartitionedTripleSet.neg_tails">
<span class="sig-name descname"><span class="pre">neg_tails</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code><span class="pre">]]]</span></em><a class="headerlink" href="#besskge.sharding.PartitionedTripleSet.neg_tails" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.PartitionedTripleSet.partition_mode">
<span class="sig-name descname"><span class="pre">partition_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></em><a class="headerlink" href="#besskge.sharding.PartitionedTripleSet.partition_mode" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.sharding.PartitionedTripleSet.partition_triples">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">partition_triples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">triples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sharding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition_mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/sharding.html#PartitionedTripleSet.partition_triples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.sharding.PartitionedTripleSet.partition_triples" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code>]], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.PartitionedTripleSet.sharding">
<span class="sig-name descname"><span class="pre">sharding</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#besskge.sharding.Sharding" title="besskge.sharding.Sharding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sharding</span></code></a></em><a class="headerlink" href="#besskge.sharding.PartitionedTripleSet.sharding" title="Permalink to this definition"></a></dt>
<dd><p>Sharding of entities</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.PartitionedTripleSet.triple_counts">
<span class="sig-name descname"><span class="pre">triple_counts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code><span class="pre">]]</span></em><a class="headerlink" href="#besskge.sharding.PartitionedTripleSet.triple_counts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.PartitionedTripleSet.triple_offsets">
<span class="sig-name descname"><span class="pre">triple_offsets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code><span class="pre">]]</span></em><a class="headerlink" href="#besskge.sharding.PartitionedTripleSet.triple_offsets" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.PartitionedTripleSet.triple_sort_idx">
<span class="sig-name descname"><span class="pre">triple_sort_idx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code><span class="pre">]]</span></em><a class="headerlink" href="#besskge.sharding.PartitionedTripleSet.triple_sort_idx" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.PartitionedTripleSet.triples">
<span class="sig-name descname"><span class="pre">triples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code><span class="pre">]]</span></em><a class="headerlink" href="#besskge.sharding.PartitionedTripleSet.triples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.PartitionedTripleSet.types">
<span class="sig-name descname"><span class="pre">types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code><span class="pre">]]]</span></em><a class="headerlink" href="#besskge.sharding.PartitionedTripleSet.types" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="besskge.sharding.Sharding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">besskge.sharding.</span></span><span class="sig-name descname"><span class="pre">Sharding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_shard</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity_to_shard</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity_to_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shard_and_idx_to_entity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shard_counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity_type_counts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity_type_offsets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/sharding.html#Sharding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.sharding.Sharding" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A mapping of entities to shards (and back again).</p>
<dl class="py method">
<dt class="sig sig-object py" id="besskge.sharding.Sharding.create">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_entity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_shard</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/sharding.html#Sharding.create"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.sharding.Sharding.create" title="Permalink to this definition"></a></dt>
<dd><p>Construct a random balanced sharding of entities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_entity</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of entities in the KG.</p></li>
<li><p><strong>n_shard</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of shards.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Seed for random sharding.</p></li>
<li><p><strong>type_offsets</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code>]]]) – shape: (n_types,)
Global offsets of entity types, defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#besskge.sharding.Sharding" title="besskge.sharding.Sharding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sharding</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Random sharding of n_entity entities in n_shard shards.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.Sharding.entity_to_idx">
<span class="sig-name descname"><span class="pre">entity_to_idx</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code><span class="pre">]]</span></em><a class="headerlink" href="#besskge.sharding.Sharding.entity_to_idx" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.Sharding.entity_to_shard">
<span class="sig-name descname"><span class="pre">entity_to_shard</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code><span class="pre">]]</span></em><a class="headerlink" href="#besskge.sharding.Sharding.entity_to_shard" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.Sharding.entity_type_counts">
<span class="sig-name descname"><span class="pre">entity_type_counts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code><span class="pre">]]]</span></em><a class="headerlink" href="#besskge.sharding.Sharding.entity_type_counts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.Sharding.entity_type_offsets">
<span class="sig-name descname"><span class="pre">entity_type_offsets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code><span class="pre">]]]</span></em><a class="headerlink" href="#besskge.sharding.Sharding.entity_type_offsets" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.sharding.Sharding.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/sharding.html#Sharding.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.sharding.Sharding.load" title="Permalink to this definition"></a></dt>
<dd><p>Load a <a class="reference internal" href="#besskge.sharding.Sharding" title="besskge.sharding.Sharding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sharding</span></code></a> saved with <a class="reference internal" href="#besskge.sharding.Sharding.save" title="besskge.sharding.Sharding.save"><code class="xref py py-func docutils literal notranslate"><span class="pre">Sharding.save()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – Path to saved <a class="reference internal" href="#besskge.sharding.Sharding" title="besskge.sharding.Sharding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sharding</span></code></a>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#besskge.sharding.Sharding" title="besskge.sharding.Sharding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sharding</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The saved <a class="reference internal" href="#besskge.sharding.Sharding" title="besskge.sharding.Sharding"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sharding</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="besskge.sharding.Sharding.max_entity_per_shard">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_entity_per_shard</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#besskge.sharding.Sharding.max_entity_per_shard" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="besskge.sharding.Sharding.n_entity">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_entity</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#besskge.sharding.Sharding.n_entity" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.Sharding.n_shard">
<span class="sig-name descname"><span class="pre">n_shard</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#besskge.sharding.Sharding.n_shard" title="Permalink to this definition"></a></dt>
<dd><p>Number of shards</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="besskge.sharding.Sharding.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/sharding.html#Sharding.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.sharding.Sharding.save" title="Permalink to this definition"></a></dt>
<dd><p>Save sharding to .npz file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out_file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – Path to output file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.Sharding.shard_and_idx_to_entity">
<span class="sig-name descname"><span class="pre">shard_and_idx_to_entity</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int32</span></code><span class="pre">]]</span></em><a class="headerlink" href="#besskge.sharding.Sharding.shard_and_idx_to_entity" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="besskge.sharding.Sharding.shard_counts">
<span class="sig-name descname"><span class="pre">shard_counts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code><span class="pre">[</span><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int64</span></code><span class="pre">]]</span></em><a class="headerlink" href="#besskge.sharding.Sharding.shard_counts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-besskge.utils">
<span id="besskge-utils"></span><h2>besskge.utils<a class="headerlink" href="#module-besskge.utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="besskge.utils.gather_indices">
<span class="sig-prename descclassname"><span class="pre">besskge.utils.</span></span><span class="sig-name descname"><span class="pre">gather_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/besskge/utils.html#gather_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#besskge.utils.gather_indices" title="Permalink to this definition"></a></dt>
<dd><p>IPU-friendly gather function like torch.take_along_dim
for 2-dimensional tensors (indices along dim=1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (a, e)</p></li>
<li><p><strong>index</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>) – shape: (a, k) or (1, k)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>shape: (a, k)
For all rows of <cite>x</cite>, take the <cite>k</cite> elements on
the row with the indices specified by
the corresponding row of <cite>index</cite>.
If <cite>index.shape == 1</cite>, the same mask is applied to all rows.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-besskge">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-besskge" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="besskge" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Graphcore Research.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>